{% extends "base.html" %}
{% block title %}Edit {{ user.username }} - RADIUS Portal{% endblock %}
{% block content %}

<p><a href="{{ url_for('users.admin_users_list') }}">&larr; Back to users</a></p>

<h2>Edit: {{ user.username }}</h2>

<div class="grid" style="grid-template-columns: 1fr 1fr;">
  <section>
    <h3>Current settings</h3>
    <ul>
      <li><b>Password:</b> {{ "set" if user.password else "—" }}</li>
      <li><b>Expiration:</b> {{ user.expiration or "—" }}</li>
    </ul>


  <h3>Audit</h3>
  
  {% if meta %}
    <ul>
      <li><b>Created:</b> {{ meta.created_at }} by <b>{{ meta.created_by }}</b></li>
      <li><b>Last updated:</b> {{ meta.updated_at }} by <b>{{ meta.updated_by }}</b></li>
      {% if meta.note %}<li><b>Note:</b> {{ meta.note }}</li>{% endif %}
    </ul>
  {% else %}
    <p class="muted">No metadata recorded for this user yet.</p>
  {% endif %}
  
  <table>
    <thead>
      <tr><th>When</th><th>Actor</th><th>Action</th><th>Detail</th></tr>
    </thead>
    <tbody>
      {% for e in audit %}
        <tr>
          <td>{{ e.occurred_at }}</td>
          <td>{{ e.actor }}</td>
          <td>{{ e.action }}</td>
          <td><pre style="margin:0; white-space:pre-wrap;">{{ e.detail | tojson }}</pre></td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  </section>
</div>

{% endblock %}
